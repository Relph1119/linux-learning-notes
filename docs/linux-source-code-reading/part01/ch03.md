# 第3回 做好访问内存的基础准备工作

## 3.1 寄存器的作用

- cs寄存器：表示代码段寄存器，CPU即将要执行的代码在内存中的位置，就是由`cs:ip`配合指向的。
- ds寄存器：表示数据段寄存器，作为访问内存数据时的基地址。
- es寄存器：表示扩展段寄存器。
- ss寄存器：表示栈段寄存器，配合栈指针寄存器sp表示此时的栈顶地址，由`ss:sp`配合指向的。

## 3.2 CPU访问内存的三种途径

- `cs:ip`访问代码
- `ds:xxx`访问数据
- `ss:sp`访问栈

## 3.3 寄存器初始化

```nasm
go:	
    mov	ax,cs           ; ax=0x9000
	mov	ds,ax           ; ds=0x9000
	mov	es,ax           ; es=0x9000
; put stack at 0x9ff00.
	mov	ss,ax           ; ss=0x9000
	mov	sp,#0xFF00	  ; arbitrary value >>512
```

## 3.4 内容总结

1. 代码从硬盘移动到内存，在内存中从`0x7c00`复制到`0x90000`处。
2. 数据段寄存器ds和代码段寄存器es设置为`0x9000`。
3. 栈顶地址设置为`0x9FF00`，其中栈段寄存器ss为`0x9000`，栈基址寄存器sp为`0xFF00`。